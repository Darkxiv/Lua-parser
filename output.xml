<chunk>
    <block>
        <stat>
            <leaf>function</leaf>
            <funcname>
                <leaf>action1</leaf>
            </funcname>
            <funcbody>
                <leaf>(</leaf>
                <leaf>)</leaf>
                <block>
                    <stat>
                        <functioncall>
                            <varOrExp>
                                <var>
                                    <leaf>print</leaf>
                                </var>
                            </varOrExp>
                            <nameAndArgs>
                                <args>
                                    <leaf>(</leaf>
                                    <explist>
                                        <exp>
                                            <string>
                                                <leaf>"action1"</leaf>
                                            </string>
                                        </exp>
                                    </explist>
                                    <leaf>)</leaf>
                                </args>
                            </nameAndArgs>
                        </functioncall>
                    </stat>
                </block>
                <leaf>end</leaf>
            </funcbody>
        </stat>
        <stat>
            <leaf>function</leaf>
            <funcname>
                <leaf>action2</leaf>
            </funcname>
            <funcbody>
                <leaf>(</leaf>
                <leaf>)</leaf>
                <block>
                    <stat>
                        <functioncall>
                            <varOrExp>
                                <var>
                                    <leaf>print</leaf>
                                </var>
                            </varOrExp>
                            <nameAndArgs>
                                <args>
                                    <leaf>(</leaf>
                                    <explist>
                                        <exp>
                                            <string>
                                                <leaf>"action2"</leaf>
                                            </string>
                                        </exp>
                                    </explist>
                                    <leaf>)</leaf>
                                </args>
                            </nameAndArgs>
                        </functioncall>
                    </stat>
                </block>
                <leaf>end</leaf>
            </funcbody>
        </stat>
        <stat>
            <leaf>function</leaf>
            <funcname>
                <leaf>FSM</leaf>
            </funcname>
            <funcbody>
                <leaf>(</leaf>
                <parlist>
                    <namelist>
                        <leaf>t</leaf>
                    </namelist>
                </parlist>
                <leaf>)</leaf>
                <block>
                    <stat>
                        <leaf>local</leaf>
                        <namelist>
                            <leaf>a</leaf>
                        </namelist>
                        <leaf>=</leaf>
                        <explist>
                            <exp>
                                <tableconstructor>
                                    <leaf>{</leaf>
                                    <leaf>}</leaf>
                                </tableconstructor>
                            </exp>
                        </explist>
                    </stat>
                    <stat>
                        <leaf>for</leaf>
                        <namelist>
                            <leaf>_</leaf>
                            <leaf>,</leaf>
                            <leaf>v</leaf>
                        </namelist>
                        <leaf>in</leaf>
                        <explist>
                            <exp>
                                <prefixexp>
                                    <varOrExp>
                                        <var>
                                            <leaf>ipairs</leaf>
                                        </var>
                                    </varOrExp>
                                    <nameAndArgs>
                                        <args>
                                            <leaf>(</leaf>
                                            <explist>
                                                <exp>
                                                    <prefixexp>
                                                        <varOrExp>
                                                            <var>
                                                                <leaf>t</leaf>
                                                            </var>
                                                        </varOrExp>
                                                    </prefixexp>
                                                </exp>
                                            </explist>
                                            <leaf>)</leaf>
                                        </args>
                                    </nameAndArgs>
                                </prefixexp>
                            </exp>
                        </explist>
                        <leaf>do</leaf>
                        <block>
                            <stat>
                                <leaf>local</leaf>
                                <namelist>
                                    <leaf>old</leaf>
                                    <leaf>,</leaf>
                                    <leaf>event</leaf>
                                    <leaf>,</leaf>
                                    <leaf>new</leaf>
                                    <leaf>,</leaf>
                                    <leaf>action</leaf>
                                </namelist>
                                <leaf>=</leaf>
                                <explist>
                                    <exp>
                                        <prefixexp>
                                            <varOrExp>
                                                <var>
                                                    <leaf>v</leaf>
                                                    <varSuffix>
                                                        <leaf>[</leaf>
                                                        <exp>
                                                            <number>
                                                                <leaf>1</leaf>
                                                            </number>
                                                        </exp>
                                                        <leaf>]</leaf>
                                                    </varSuffix>
                                                </var>
                                            </varOrExp>
                                        </prefixexp>
                                    </exp>
                                    <leaf>,</leaf>
                                    <exp>
                                        <prefixexp>
                                            <varOrExp>
                                                <var>
                                                    <leaf>v</leaf>
                                                    <varSuffix>
                                                        <leaf>[</leaf>
                                                        <exp>
                                                            <number>
                                                                <leaf>2</leaf>
                                                            </number>
                                                        </exp>
                                                        <leaf>]</leaf>
                                                    </varSuffix>
                                                </var>
                                            </varOrExp>
                                        </prefixexp>
                                    </exp>
                                    <leaf>,</leaf>
                                    <exp>
                                        <prefixexp>
                                            <varOrExp>
                                                <var>
                                                    <leaf>v</leaf>
                                                    <varSuffix>
                                                        <leaf>[</leaf>
                                                        <exp>
                                                            <number>
                                                                <leaf>3</leaf>
                                                            </number>
                                                        </exp>
                                                        <leaf>]</leaf>
                                                    </varSuffix>
                                                </var>
                                            </varOrExp>
                                        </prefixexp>
                                    </exp>
                                    <leaf>,</leaf>
                                    <exp>
                                        <prefixexp>
                                            <varOrExp>
                                                <var>
                                                    <leaf>v</leaf>
                                                    <varSuffix>
                                                        <leaf>[</leaf>
                                                        <exp>
                                                            <number>
                                                                <leaf>4</leaf>
                                                            </number>
                                                        </exp>
                                                        <leaf>]</leaf>
                                                    </varSuffix>
                                                </var>
                                            </varOrExp>
                                        </prefixexp>
                                    </exp>
                                </explist>
                            </stat>
                            <stat>
                                <leaf>if</leaf>
                                <exp>
                                    <exp>
                                        <prefixexp>
                                            <varOrExp>
                                                <var>
                                                    <leaf>a</leaf>
                                                    <varSuffix>
                                                        <leaf>[</leaf>
                                                        <exp>
                                                            <prefixexp>
                                                                <varOrExp>
                                                                    <var>
                                                                        <leaf>old</leaf>
                                                                    </var>
                                                                </varOrExp>
                                                            </prefixexp>
                                                        </exp>
                                                        <leaf>]</leaf>
                                                    </varSuffix>
                                                </var>
                                            </varOrExp>
                                        </prefixexp>
                                    </exp>
                                    <operatorComparison>
                                        <leaf>==</leaf>
                                    </operatorComparison>
                                    <exp>
                                        <leaf>nil</leaf>
                                    </exp>
                                </exp>
                                <leaf>then</leaf>
                                <block>
                                    <stat>
                                        <varlist>
                                            <var>
                                                <leaf>a</leaf>
                                                <varSuffix>
                                                    <leaf>[</leaf>
                                                    <exp>
                                                        <prefixexp>
                                                            <varOrExp>
                                                                <var>
                                                                    <leaf>old</leaf>
                                                                </var>
                                                            </varOrExp>
                                                        </prefixexp>
                                                    </exp>
                                                    <leaf>]</leaf>
                                                </varSuffix>
                                            </var>
                                        </varlist>
                                        <leaf>=</leaf>
                                        <explist>
                                            <exp>
                                                <tableconstructor>
                                                    <leaf>{</leaf>
                                                    <leaf>}</leaf>
                                                </tableconstructor>
                                            </exp>
                                        </explist>
                                    </stat>
                                </block>
                                <leaf>end</leaf>
                            </stat>
                            <stat>
                                <varlist>
                                    <var>
                                        <leaf>a</leaf>
                                        <varSuffix>
                                            <leaf>[</leaf>
                                            <exp>
                                                <prefixexp>
                                                    <varOrExp>
                                                        <var>
                                                            <leaf>old</leaf>
                                                        </var>
                                                    </varOrExp>
                                                </prefixexp>
                                            </exp>
                                            <leaf>]</leaf>
                                        </varSuffix>
                                        <varSuffix>
                                            <leaf>[</leaf>
                                            <exp>
                                                <prefixexp>
                                                    <varOrExp>
                                                        <var>
                                                            <leaf>event</leaf>
                                                        </var>
                                                    </varOrExp>
                                                </prefixexp>
                                            </exp>
                                            <leaf>]</leaf>
                                        </varSuffix>
                                    </var>
                                </varlist>
                                <leaf>=</leaf>
                                <explist>
                                    <exp>
                                        <tableconstructor>
                                            <leaf>{</leaf>
                                            <fieldlist>
                                                <field>
                                                    <leaf>new</leaf>
                                                    <leaf>=</leaf>
                                                    <exp>
                                                        <prefixexp>
                                                            <varOrExp>
                                                                <var>
                                                                    <leaf>new</leaf>
                                                                </var>
                                                            </varOrExp>
                                                        </prefixexp>
                                                    </exp>
                                                </field>
                                                <fieldsep>
                                                    <leaf>,</leaf>
                                                </fieldsep>
                                                <field>
                                                    <leaf>action</leaf>
                                                    <leaf>=</leaf>
                                                    <exp>
                                                        <prefixexp>
                                                            <varOrExp>
                                                                <var>
                                                                    <leaf>action</leaf>
                                                                </var>
                                                            </varOrExp>
                                                        </prefixexp>
                                                    </exp>
                                                </field>
                                            </fieldlist>
                                            <leaf>}</leaf>
                                        </tableconstructor>
                                    </exp>
                                </explist>
                            </stat>
                        </block>
                        <leaf>end</leaf>
                    </stat>
                    <retstat>
                        <leaf>return</leaf>
                        <explist>
                            <exp>
                                <prefixexp>
                                    <varOrExp>
                                        <var>
                                            <leaf>a</leaf>
                                        </var>
                                    </varOrExp>
                                </prefixexp>
                            </exp>
                        </explist>
                    </retstat>
                </block>
                <leaf>end</leaf>
            </funcbody>
        </stat>
        <stat>
            <varlist>
                <var>
                    <leaf>fsm</leaf>
                </var>
            </varlist>
            <leaf>=</leaf>
            <explist>
                <exp>
                    <prefixexp>
                        <varOrExp>
                            <var>
                                <leaf>FSM</leaf>
                            </var>
                        </varOrExp>
                        <nameAndArgs>
                            <args>
                                <tableconstructor>
                                    <leaf>{</leaf>
                                    <fieldlist>
                                        <field>
                                            <exp>
                                                <tableconstructor>
                                                    <leaf>{</leaf>
                                                    <fieldlist>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"state1"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"event1"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"state2"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <prefixexp>
                                                                    <varOrExp>
                                                                        <var>
                                                                            <leaf>action1</leaf>
                                                                        </var>
                                                                    </varOrExp>
                                                                </prefixexp>
                                                            </exp>
                                                        </field>
                                                    </fieldlist>
                                                    <leaf>}</leaf>
                                                </tableconstructor>
                                            </exp>
                                        </field>
                                        <fieldsep>
                                            <leaf>,</leaf>
                                        </fieldsep>
                                        <field>
                                            <exp>
                                                <tableconstructor>
                                                    <leaf>{</leaf>
                                                    <fieldlist>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"state1"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"event2"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <string>
                                                                    <leaf>"state3"</leaf>
                                                                </string>
                                                            </exp>
                                                        </field>
                                                        <fieldsep>
                                                            <leaf>,</leaf>
                                                        </fieldsep>
                                                        <field>
                                                            <exp>
                                                                <prefixexp>
                                                                    <varOrExp>
                                                                        <var>
                                                                            <leaf>action2</leaf>
                                                                        </var>
                                                                    </varOrExp>
                                                                </prefixexp>
                                                            </exp>
                                                        </field>
                                                    </fieldlist>
                                                    <leaf>}</leaf>
                                                </tableconstructor>
                                            </exp>
                                        </field>
                                        <fieldsep>
                                            <leaf>,</leaf>
                                        </fieldsep>
                                    </fieldlist>
                                    <leaf>}</leaf>
                                </tableconstructor>
                            </args>
                        </nameAndArgs>
                    </prefixexp>
                </exp>
            </explist>
        </stat>
        <stat>
            <leaf>local</leaf>
            <namelist>
                <leaf>a</leaf>
            </namelist>
            <leaf>=</leaf>
            <explist>
                <exp>
                    <prefixexp>
                        <varOrExp>
                            <var>
                                <leaf>fsm</leaf>
                                <varSuffix>
                                    <leaf>[</leaf>
                                    <exp>
                                        <string>
                                            <leaf>"state1"</leaf>
                                        </string>
                                    </exp>
                                    <leaf>]</leaf>
                                </varSuffix>
                                <varSuffix>
                                    <leaf>[</leaf>
                                    <exp>
                                        <string>
                                            <leaf>"event1"</leaf>
                                        </string>
                                    </exp>
                                    <leaf>]</leaf>
                                </varSuffix>
                            </var>
                        </varOrExp>
                    </prefixexp>
                </exp>
            </explist>
        </stat>
        <stat>
            <functioncall>
                <varOrExp>
                    <var>
                        <leaf>a</leaf>
                        <varSuffix>
                            <leaf>.</leaf>
                            <leaf>action</leaf>
                        </varSuffix>
                    </var>
                </varOrExp>
                <nameAndArgs>
                    <args>
                        <leaf>(</leaf>
                        <leaf>)</leaf>
                    </args>
                </nameAndArgs>
            </functioncall>
        </stat>
        <stat>
            <varlist>
                <var>
                    <leaf>state</leaf>
                </var>
            </varlist>
            <leaf>=</leaf>
            <explist>
                <exp>
                    <prefixexp>
                        <varOrExp>
                            <var>
                                <leaf>a</leaf>
                                <varSuffix>
                                    <leaf>.</leaf>
                                    <leaf>new</leaf>
                                </varSuffix>
                            </var>
                        </varOrExp>
                    </prefixexp>
                </exp>
            </explist>
        </stat>
    </block>
    <leaf><EOF></leaf>
</chunk>
